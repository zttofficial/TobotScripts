check=1

hulangsi = {}
hulangsi.chname = "虎狼寺" --副本名称--
hulangsi.donum = 3 --副本次数--
hulangsi.buffname = nil --BUFF名称，为nil表示没有BUFF要求--
hulangsi.targetthingname = "虎狼寺元宝" --目标道具名称，为nil表示没有需要计数的道具--
hulangsi.warning = nil --提示，为nil表示没有提示--
hulangsi.version = "1.1.0.06142" --版本号--

local function isInMap()
	if getmapid() == 20600.0 
	or getmapid() == 20601.0 
	or getmapid() == 20602.0 
	or getmapid() == 20603.0 then
		return true
	end
	return false
end

local function isNumEnd()
	if indun_get(hulangsi.chname) == hulangsi.donum 
		and not isInMap() then 
		return true
	end
	
	return false
end

local function planeToEntry()
	if getmapid() ~= 63404.0 then
		plane(123)
		wait_loadmap()
	end
end

local targetthingnum = 0

local function intTargetThingNum()
	if hulangsi.targetthingname then
		targetthingnum = item_if(hulangsi.targetthingname)
	end
end

local function printTargetThingNum()
	if hulangsi.targetthingname then
		printgame(0,255,255,"当前["..hulangsi.targetthingname.."]数量："..item_if(hulangsi.targetthingname))
		printgame(0,255,255,"副本内获取["..hulangsi.targetthingname.."]数："..(item_if(hulangsi.targetthingname) - targetthingnum))
	end
end

function hulangsi.begin()
	bot_stop()--停止挂机--
	
	printgame(0,255,255,"此Lua为全自动["..hulangsi.chname.."]"..hulangsi.donum.."次 在任意地图载入启动 若按错 你有5秒时间停止载入")
	local printtime = 2000
	sleep(30)
	printtime = printtime - 30
	if hulangsi.warning then
		printgame(255,255,0,"提示："..hulangsi.warning)
		sleep(30)
		printtime = printtime - 30
	end
	printgame(0,255,255,"Version: "..hulangsi.version)
	sleep(30)
	printtime = printtime - 30
	printgame(0,255,255,"Code by Tom")
	sleep(30)
	printtime = printtime - 30
	printgame(0,255,255,"联系方式：QQ644540771")
	sleep(printtime)
	maketeam()
	sleep(3000)
				
	if isNumEnd() then
		printgame(0,255,255,"["..hulangsi.chname.."]已刷完"..hulangsi.donum.."次，此Lua执行完毕")
		return
	end
	
	ini_change("tobot_scriptbot",1)--启动脚本挂机--
	
	if hulangsi.buffname then
	
	else
		if not isInMap() then
			planeToEntry()
		end
	end
	
	intTargetThingNum()
		
	while(true)
	do
		sleep(30)
		mapid_now = getmapid()
		if mapid_now ~= mapid_last then--防止加载地图崩溃--
			mapid_last = mapid_now
			if getmapid() == 63404.0 then
				bot_stop()--禁止挂机--
				if isNumEnd() then
					ini_change("tobot_scriptbot", 0)--停止脚本挂机--
					ini_change("ban_hit_mob",0)--允许攻击--
					sleep(1000)
					printgame(0,255,255,"["..hulangsi.chname.."]已刷完"..hulangsi.donum.."次，此Lua执行完毕")
					sleep(30)
					printTargetThingNum()
					return
				end
				script_txt_loaddata("D6C7C4DCD7AAC9ED2CD3D2C5DCCAB12C3939302E3134342C313032332E30382CD7F3C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C3634372E3939382C313032332E30382CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C3833392E3234362C313032332E30382CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C",1)
				bot_start()--启动挂机--
			end
			
			if getmapid() == 20600.0 then
				bot_stop()--禁止挂机--
				ini_change("ban_hit_mob",1)--禁止攻击--
				script_txt_loaddata("D6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C33322C313435352E36342CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD3D2CCF82CD3D2C5DCCAB12C313230392E36352C313333342E362CB2BBB1E42CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD3D2CCF82CD3D2C5DCCAB12C333634332E32352C313334382E362CB2BBB1E42CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD3D2C5DCCAB12C363336372C313437312E37362CD7F3C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C353732382E38382C313437312E37362CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C323439362E36332C313437312E30382CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C363231372E36342C313437312E34342CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C",2)
				bot_start()--启动挂机--
			end
			
			if getmapid() == 20601.0 then
				bot_stop()--禁止挂机--
				ini_change("ban_hit_mob",1)--禁止攻击--
				script_txt_loaddata("D6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C33322C313435352E36342CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD3D2CCF82CD3D2C5DCCAB12C3633302E3330392C313332312E39322CB2BBB1E42CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C33322C313437312E32342CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C313838382E35342C313437312E33362CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD3D2CCF82CD3D2C5DCCAB12C343434352E38362C313334362E30382CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C363131322E35322C313437312E33362CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD3D2C5DCCAB12C363336372C313437312E33362CD7F3C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C363234392E30312C313437312E33362CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C",2)
				bot_start()--启动挂机--
			end
			
			if getmapid() == 20602.0 then
				bot_stop()--禁止挂机--
				ini_change("ban_hit_mob",1)--禁止攻击--
				script_txt_loaddata("D6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C33322C313432332E36382CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD3D2CCF82CD3D2C5DCCAB12C3430352C313330362E32382CB2BBB1E42CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD3D2C5DCCAB12C313636322E30382C313236332E38382CD7F3C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD7F3CCF82BC9CFC5C0CCDDD7D32CD7F326D3D2CAB12C313238352E30332C313236332E35362CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C3538322E3133312C3839352E31362CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C323830392E36342C3839352E31362CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD3D2C5DCCAB12C333136372C3839352E31362CD7F3C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333039322E37312C3839352E31362CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD3D2C5DCCAB12C333136372C3532372E32342CD7F3C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C323038392E372C3532372E32342CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0ACFC2C5C0CCDDD7D32CD7F326D3D2CAB12C323434382E32332C3532372E3634312CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C",2)
				bot_start()--启动挂机--
			end
			
			if getmapid() == 20603.0 then
				bot_stop()--禁止挂机--
				ini_change("ban_hit_mob",0)--允许攻击--
				script_txt_loaddata("D6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C33322C313032332E30382CD3D2C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C0D0AD6C7C4DCD7AAC9ED2CD3D2C5DCCAB12C313732372C313032332E30382CD7F3C5DC2CC3BBD3D0B8BDBCD3B2CECAFD2C",2)
				bot_start()--启动挂机--
				while(true)
				do
					sleep(30)
					if getmapid() ~= 20603.0 then
						break
					end
					
					if door_if(1131,1023) == 1 then --检测门口出来没有--
						bot_stop()--停止挂机--
						sleep(3000)
						planeToEntry()
						break
					end
				end
			end
		end
	end
end

hulangsi.begin()

return hulangsi